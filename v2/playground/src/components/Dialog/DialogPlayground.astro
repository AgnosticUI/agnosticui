---
import { Home, MessageSquare, AlertCircle } from "lucide-astro";
import ReactDialogDemo from "../ReactDialogDemo.tsx";
import VueDialogDemo from "../VueDialogDemo.vue";
import SvelteDialogDemo from "../SvelteDialogDemo.svelte";
---

<style is:global>
  .nav-breadcrumb {
    margin-bottom: 1rem;
    padding-bottom: 1rem;
    border-bottom: 1px solid var(--c-border);
  }

  .nav-home {
    display: flex;
    align-items: center;
    gap: 0.5rem;
    color: var(--c-text-light);
    font-size: 0.9rem;
    text-decoration: none;
    transition: color 0.2s ease;
  }

  .nav-home:hover {
    color: var(--ag-primary);
  }

  .nav-home svg {
    width: 1.25rem;
    height: 1.25rem;
  }

  /* AgnosticUI Button Styling */
  ag-button {
    --button-bg: var(--c-card-bg);
    --button-border: var(--c-border);
    --button-color: var(--c-text);
    --button-padding: 0.5rem 1rem;
    --button-radius: 0.375rem;
    --button-font-weight: 500;
  }

  ag-button::part(button) {
    background: var(--button-bg);
    border: 1px solid var(--button-border);
    color: var(--button-color);
    padding: var(--button-padding);
    border-radius: var(--button-radius);
    font-weight: var(--button-font-weight);
    transition: all 0.2s ease;
  }

  /* High contrast focus ring for all button variants */
  ag-button::part(button):focus-visible {
    outline: 2px solid var(--ag-focus);
    outline-offset: 2px;
  }

  /* Default button hover */
  ag-button::part(button):hover:not(:disabled) {
    background: var(--c-bg-secondary);
    border-color: var(--ag-primary);
  }

  /* Primary variant */
  ag-button[variant="primary"]::part(button) {
    background: var(--ag-primary);
    color: white;
    border-color: var(--ag-primary);
  }

  ag-button[variant="primary"]::part(button):hover:not(:disabled) {
    background: var(--ag-primary-hover);
    border-color: var(--ag-primary-hover);
  }

  /* Secondary variant */
  ag-button[variant="secondary"]::part(button) {
    background: transparent;
    color: var(--ag-primary);
    border-color: var(--ag-primary);
  }

  ag-button[variant="secondary"]::part(button):hover:not(:disabled) {
    background: var(--ag-primary);
    color: white;
    border-color: var(--ag-primary);
  }

  /* Danger variant */
  ag-button[variant="danger"]::part(button) {
    background: var(--ag-danger);
    color: white;
    border-color: var(--ag-danger);
  }

  ag-button[variant="danger"]::part(button):hover:not(:disabled) {
    background: var(--ag-danger-hover);
    border-color: var(--ag-danger-hover);
  }

  /* Outline variant */
  ag-button[variant="outline"]::part(button) {
    background: transparent;
    color: var(--c-text);
    border-color: var(--c-border);
  }

  ag-button[variant="outline"]::part(button):hover:not(:disabled) {
    background: var(--c-bg-secondary);
    border-color: var(--ag-primary);
    color: var(--ag-primary);
  }

  /* Dialog styling to match theme */
  ag-dialog {
    --dialog-bg: var(--c-card-bg);
    --dialog-border: var(--c-card-border);
    --dialog-description-color: var(--c-text-light);
    --dialog-heading-color: var(--c-text);
    --dialog-shadow: 0 20px 25px -5px rgba(0, 0, 0, 0.1), 0 10px 10px -5px rgba(0, 0, 0, 0.04);
  }
</style>

<div>
  <nav class="nav-breadcrumb">
    <a href="/" class="nav-home">
      <Home />
      <span>Home</span>
    </a>
    / Dialog
  </nav>

  <h1>Dialog Component</h1>
  <p>Modal dialog component with accessibility features.</p>

  <section>
    <h2>Focus Trapping Demo</h2>
    <p style="color: var(--c-text-light); margin-bottom: 1rem;">
      This dialog demonstrates focus trapping with multiple interactive
      elements. Try:
      <br />• <strong>Tab</strong> to move forward through focusable elements
      <br />• <strong>Shift+Tab</strong> to move backward
      <br />• <strong>Escape</strong> to close the dialog
      <br />• Notice how focus stays trapped within the dialog boundaries
    </p>

    <div class="component-showcase">
      <ag-tabs activation="manual" active-tab="0" aria-label="Focus Trapping Demo example">
        <ag-tab slot="tab" panel="focus-preview-panel">Preview</ag-tab>
        <ag-tab slot="tab" panel="focus-code-panel">Code</ag-tab>

        <ag-tab-panel slot="panel" id="focus-preview-panel">
          <div class="preview-container">
            <ag-dialog
              id="demo-dialog"
              heading="Focus Trapping Demo"
              description="Use Tab and Shift+Tab to navigate between these buttons. Notice how focus stays within the dialog."
              show-close-button="true"
              open="false"
            >
              <div style="display: flex; flex-direction: column; gap: 0.75rem;">
                <ag-button variant="primary">Primary Button</ag-button>

                <input
                  type="text"
                  placeholder="Focus me with Tab"
                  style="background: var(--c-card-bg); border: 1px solid var(--c-card-border); padding: 0.5rem; border-radius: 0.5rem;"
                />

                <ag-button variant="secondary">Secondary Button</ag-button>

                <textarea
                  placeholder="Try typing here..."
                  style="background: var(--c-card-bg); border: 1px solid var(--c-card-border); padding: 0.5rem; border-radius: 0.5rem; min-height: 60px; resize: vertical;"
                ></textarea>

                <div
                  style="display: flex; gap: 0.5rem; justify-content: flex-end; margin-top: 0.5rem;"
                >
                  <ag-button
                    variant="outline"
                    onclick="document.getElementById('demo-dialog').open = false"
                    >Cancel</ag-button
                  >
                  <ag-button
                    variant="danger"
                    onclick="document.getElementById('demo-dialog').open = false"
                    >Confirm Action</ag-button
                  >
                </div>
              </div>
            </ag-dialog>
            <button onclick="document.getElementById('demo-dialog').open = true"
              >Open Dialog</button
            >
          </div>
        </ag-tab-panel>

        <ag-tab-panel slot="panel" id="focus-code-panel">
          <div class="code-container">
            <pre><code class="language-html">{`<!-- Dialog with focus trapping -->
<ag-dialog
  id="demo-dialog"
  heading="Focus Trapping Demo"
  description="Use Tab and Shift+Tab to navigate between these buttons."
  show-close-button="true"
>
  <div style="display: flex; flex-direction: column; gap: 0.75rem;">
    <ag-button variant="primary">Primary Button</ag-button>

    <input type="text" placeholder="Focus me with Tab" />

    <ag-button variant="secondary">Secondary Button</ag-button>

    <textarea placeholder="Try typing here..."></textarea>

    <div style="display: flex; gap: 0.5rem; justify-content: flex-end;">
      <ag-button variant="outline" onclick="closeDialog()">Cancel</ag-button>
      <ag-button variant="danger" onclick="closeDialog()">Confirm</ag-button>
    </div>
  </div>
</ag-dialog>

<!-- Trigger button -->
<button onclick="document.getElementById('demo-dialog').open = true">
  Open Dialog
</button>

<script>
function closeDialog() {
  document.getElementById('demo-dialog').open = false;
}
</script>`}</code></pre>
          </div>
        </ag-tab-panel>
      </ag-tabs>
    </div>
  </section>

  <section>
    <h2>React Integration</h2>
    <p>
      The ReactDialog wrapper provides seamless integration with React
      applications while maintaining all the accessibility features of the
      underlying web component.
    </p>

    <div class="component-showcase">
      <ag-tabs activation="manual" active-tab="0" aria-label="React Integration example">
        <ag-tab slot="tab" panel="react-preview-panel">Preview</ag-tab>
        <ag-tab slot="tab" panel="react-code-panel">Code</ag-tab>

        <ag-tab-panel slot="panel" id="react-preview-panel">
          <div class="preview-container">
            <ReactDialogDemo client:only="react" />
          </div>
        </ag-tab-panel>

        <ag-tab-panel slot="panel" id="react-code-panel">
          <div class="code-container">
            <pre><code class="language-tsx">{`import { ReactDialog } from 'agnosticui-react';
import { useState } from 'react';

const MyComponent = () => {
  const [isOpen, setIsOpen] = useState(false);

  const handleClose = () => {
    setIsOpen(false);
    console.log('Dialog closed');
  };

  const handleConfirm = () => {
    console.log('Action confirmed');
    setIsOpen(false);
  };

  return (
    <div>
      <button onClick={() => setIsOpen(true)}>
        Open React Dialog
      </button>

      <ReactDialog
        open={isOpen}
        heading="Confirm Action"
        description="Are you sure you want to perform this action?"
        showCloseButton={true}
        onClose={handleClose}
      >
        <div style={{ display: 'flex', gap: '0.5rem', justifyContent: 'flex-end' }}>
          <button onClick={handleClose}>Cancel</button>
          <button onClick={handleConfirm}>Confirm</button>
        </div>
      </ReactDialog>
    </div>
  );
};

export default MyComponent;`}</code></pre>
          </div>
        </ag-tab-panel>
      </ag-tabs>
    </div>
  </section>

  <section>
    <h2>Vue Integration</h2>
    <p>
      The VueDialog wrapper provides seamless integration with Vue 3 applications
      using the Composition API while maintaining all the accessibility features
      of the underlying web component.
    </p>

    <div class="component-showcase">
      <ag-tabs activation="manual" active-tab="0" aria-label="Vue Integration example">
        <ag-tab slot="tab" panel="vue-preview-panel">Preview</ag-tab>
        <ag-tab slot="tab" panel="vue-code-panel">Code</ag-tab>

        <ag-tab-panel slot="panel" id="vue-preview-panel">
          <div class="preview-container">
            <VueDialogDemo client:only="vue" />
          </div>
        </ag-tab-panel>

        <ag-tab-panel slot="panel" id="vue-code-panel">
          <div class="code-container">
            <pre><code class="language-html">{`<template>
  <div>
    <button @click="isOpen = true">
      Open Vue Dialog
    </button>

    <VueDialog
      :open="isOpen"
      heading="Confirm Action"
      description="Are you sure you want to perform this action?"
      :show-close-button="true"
      @close="handleClose"
    >
      <div style="display: flex; gap: 0.5rem; justify-content: flex-end;">
        <button @click="handleClose">Cancel</button>
        <button @click="handleConfirm">Confirm</button>
      </div>
    </VueDialog>
  </div>
</template>

<script setup>
import { ref } from 'vue';
import { VueDialog } from 'agnosticui-vue';

const isOpen = ref(false);

const handleClose = () => {
  isOpen.value = false;
  console.log('Dialog closed');
};

const handleConfirm = () => {
  console.log('Action confirmed');
  isOpen.value = false;
};
</script>`}</code></pre>
          </div>
        </ag-tab-panel>
      </ag-tabs>
    </div>
  </section>

  <section>
    <h2>Svelte Integration</h2>
    <p>
      AgnosticUI dialogs work excellently with Svelte 5 using direct web component integration.
      This approach provides the best performance and reliability while maintaining full reactivity
      and all accessibility features.
    </p>

    <div class="component-showcase">
      <ag-tabs activation="manual" active-tab="0" aria-label="Svelte Integration example">
        <ag-tab slot="tab" panel="svelte-preview-panel">Preview</ag-tab>
        <ag-tab slot="tab" panel="svelte-code-panel">Code</ag-tab>

        <ag-tab-panel slot="panel" id="svelte-preview-panel">
          <div class="preview-container">
            <SvelteDialogDemo client:only="svelte" />
          </div>
        </ag-tab-panel>

        <ag-tab-panel slot="panel" id="svelte-code-panel">
          <div class="code-container">
            <pre><code class="language-html">{`<script>
  import 'agnosticui-core';
  import { onMount } from 'svelte';

  let dialogRef;
  let isOpen = false;

  onMount(() => {
    if (dialogRef) {
      dialogRef.addEventListener('close', handleClose);
    }
  });

  const openDialog = () => {
    isOpen = true;
    if (dialogRef) {
      dialogRef.open = true;
    }
  };

  const handleClose = () => {
    isOpen = false;
    console.log('Dialog closed');
  };

  const handleConfirm = () => {
    console.log('Action confirmed');
    isOpen = false;
    if (dialogRef) {
      dialogRef.open = false;
    }
  };
</script>

<button on:click={openDialog}>
  Open Svelte Dialog
</button>

<ag-dialog
  bind:this={dialogRef}
  heading="Confirm Action"
  description="Are you sure you want to perform this action?"
  show-close-button="true"
>
  <div style="display: flex; gap: 0.5rem; justify-content: flex-end;">
    <button on:click={handleClose}>Cancel</button>
    <button on:click={handleConfirm}>Confirm</button>
  </div>
</ag-dialog>`}</code></pre>
          </div>
        </ag-tab-panel>
      </ag-tabs>
    </div>
  </section>
</div>

<script>
  document.addEventListener("DOMContentLoaded", async () => {
    try {
      // Import the Dialog component
      await import("agnosticui-core");

      // Wait for the custom element to be defined
      await customElements.whenDefined("ag-dialog");

      // Initialize syntax highlighting for tab content
      if (typeof window.initSyntaxHighlighting === 'function') {
        window.initSyntaxHighlighting();
      }
    } catch (error) {
      console.error("Error loading dialog component:", error);
    }
  });
</script>
